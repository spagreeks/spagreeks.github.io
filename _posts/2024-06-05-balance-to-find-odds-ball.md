---
layout: post
title:  用天平找出重量不一样的小球
date:   2025-03-02 18:22:22 +0800
categories: jekyll update
---


- 文章很长，懂了个大概的以前接触过这类问题的，可以直接最后看总结

- ## 问题描述
  
  首先我们来描述一下问题：  
  
  > $12$ 个小球，它们颜色形状一模一样，其中一个球的重量与其他球不同——可能轻可能重，如何用一个天平秤量 3 次找出这个小球。  
  
  这是网络上一个广泛的问题，据说是微软面试题，其中「逻辑学导论第 15 版」2.4节后面的习题也抛出了这个问题。网络上目前有众多答案，但是我找了一圈并没有找到满意的答案 —— 主要是网上找到的答案太过复杂！。最近由于 AI 的兴起，我试着问了一下，无论 是OpenAI 的 ChatGPT，还是 Google 的 Gemini，都没能给出满意的答复 —— 甚至是错的答案。这次，我准备自己努力，尽量给出一个通俗易懂的答案 —— 我会基于最基本的逻辑推理来阐述 —— 不会引入什么信息学等复杂概率。  
- ### 称量 3 次行不行？
  我们先用数学简单分析一下行不行！。  
  
	1. 先找出有多少种可能性：  
  
$n$ 个小球，任何一个小球都有可能是要找的小球，每个小球都有 $2$ 种可能 —— 重或轻，那么一共有 $2n$ 种可能。(**公式1**)  
	2. 每秤量一次，可以排除多少种可能了？。首先我们要有一个共识，就是每次天平两边应该放同样数量的球，不然测量就毫无意义。  
  
天平两边各放 $p$ 个球，那么不参与秤量的球就是 $n - 2p$ 个。如果天平平衡, 那么问题小球肯定在不参与秤量的 $n - 2p$ 个当中，根据(**公式1**)，余下的可能性也就是 $2 \times (n - 2p)$ 种；如果天平不平衡（不失一般性，可以假设左边重，右边轻），那么问题小球肯定在天平上，要么是左边的 $p$ 个偏重（这 $p$ 个排除了偏轻的可能了），要么是右边的 $p$ 个偏轻，因此余下的可能性是 $p + p = 2p$ 种。  
  
根据二分法原理，我们最好让平衡和不平衡的余下可能性相等 —— 不然就成为碰运气问题了。由 $2 \times (n - 2p) = 2p$ 可以得出 $p = n / 3$ ，同样 $n - 2p = n / 3$ 。
	  > 因此我们得出，初始情况， 小球分成 3 分， 1 份左边，1 份右边，1 份不参与秤量（**推论1**）。  
注意看，这是基于二分法逻辑推理得出的结论，至于其他人说的三分法，那是错误的答案，因为每次秤量，天平实际上只有两种情况 —— 平衡、不平衡，并不是三种情况 —— 平衡、左边重、右边重，因为无论左边重，还是右边重都是不平衡的一般性情况（上帝不分左右）。  
	3. $n$ 个球需要秤量多少次？  
  
一开始可能性是 $2n$ 种，一次称量之后余下的可能性是 $2p = \frac{1}{3} \cdot 2n$ 种 —— 前一次的 $\frac{1}{3}$ 。因此 $k$ 次称量之后，剩余可能性为 $\frac{1}{3^k} \cdot 2n$ 。剩余 $1$ 种可能的时候，问题小球就找到了，于是令 $\frac{1}{3^k} \cdot 2n = 1$ 可得： $k = \log_3 2n$ 。(**公式2**)  
  
将 $12$ 个代入(**公式2**)， $k = \log_3 (2 \times 12) \approx 2.89$ ，结论是大于 2 次， 所以向上取整 3 次。因此 3 次是完全可以的。

- ### 天平不平衡的时候，下一次如何秤量
  
  细心的你可能发现了，上述分析中，如果一次称量后，天平平衡好说，因为问题球在未称量的球当中，于是问题和一开始一样，都是从未知轻重的球中找问题球。真正的挑战在于天平不平衡的时候，这时候问题小球要么在左边的重的当中，要么在右边的轻的当中，那么是否有方式进行下一次称量使得可能性仍然可以缩减成前一次的 $1/3$ 呢？答案是肯定的。  
  
  仍然不失一般性，假设称量之后天平左重右轻。左边的球全部标记上重，右边的标记上轻，此种标记仅仅代表可能重或者可能轻，并不代表真的就是重的或轻的。  
  
	1. 如果从左右两边拿出去一部分球，并且之后用标准球平衡两边数目（此时未参与秤量的球是标准球，因为问题球在左右两边），那么天平可能平衡 —— 问题球被拿出去了，或者保持不变—— 问题球还在天平上。  
	2. 如果从左右两边移动一部分球，左边的移到右边，右边的移到左边，并且之后用标准球平衡两边数目，那么天平可能右重左轻 —— 问题球在移动的球中，或者保持不变——问题球在没有移动的球中。  
  
我们依次进行 1、2 两个步骤之后 —— 先拿出一部分球，然后再移动一部分球：  
  
如果天平变平衡了，那么问题球在拿出去球这部分中；  
  
如果天平改变方向了（右重左轻），那么问题球在移动的这部分中;  
  
如果天平状态没变，那么问题球在没有移动的这部分中；  
  
  
采用 $3$ 分法——不赌博，我们分别让 $3$ 部分小球数量相等，那么无论哪种情况，问题小球数量都只有前一次的 $1/3$ 。余下可能性也是前一次的 $1/3$ ，因为此时每个小球轻重可能都标记好了。
	  > 根据天平倾斜情况，左右两边的球分别标记好轻或重，然后分成 3 等份，1 份挪出去，1 份移动到天平另外一侧 —— 左边的移动到右边，右边的移动到左边，剩下 1 份保持原状。(**推论2**)  
到此为止，无论天平平衡还是不平衡，我们下一次的称量方案都有了。上述分析也为前面的的称量次数的计算(**公式2**)提供了逻辑依据。

- ### $12$ 个球实例演示
  
	1. 第一次称量，根据(**推论1**)，分成 $3$ 份，每份 $4$ 个，假设天平不平衡出来了，不失一般性，左重右轻。不参与称量的 4 个球就是标准球
	  > 平衡的情况比较简单 —— 继续采取(**推论1**)的方式秤剩下的球就行  
	2. 第二次称量，根据(**推论2**), 将 2 组 $8$ 个球分成 3 份 —— 现在就好比把 2 堆不同颜色的球分成 3 份，总会有 1 份混色的，为了简化问题，我们尽量保持 2 份是清一色，其中 1 份混色。因此：  
		1. 先从右边拿出第 1 份的 $2$ 个球 —— 标记都是轻
	2. 从左边挪动第 2 份的 $3$ 个球到右边 —— 标记都是重
	3. 第 3 份就是没动的球，其中包含: 左边的 $1$ 个——标记为重，右边的 $2$ 个 —— 标记为轻  
  
此时，左边 $1$ 个球，右边 $5$ 个球，左边加入 $4$ 个标准球，使得左右数目相等。接下来第 3 次  
	3. 根据第 2 次天平倾斜情况来选择如何进行第 3 次称量  
	1. 如果天平平衡，问题球就在第 1 份球中 —— 此时将第 1 份 $2$ 个小球放天平上，因为都标记为轻，所以谁轻谁是问题球;
	2. 如果天平方向改变，问题球就在第 2 份中 —— 此时，从第 $2$ 份拿两个分别放天平两边，谁重谁是问题球，如果平衡，没拿的那个就是问题球；
	3. 如果天平方向没变，问题球在第 3 份中 —— 此时， $2$ 个标记为轻的秤一下，谁轻谁就是问题球，平衡就是那个标记为重的是问题球；  
  
  
第 3 次称量，由于球的数量比较少，我们思考一下能找到方案，但是如果第 3 次称量的时候，仍然还有很多球，这时候，需要找到一个统一的方法，或许你已经发现，第 3 次称量实际上是可以采取第二次那种方案的—— 标记为重的球为 1 组， 标记为轻的球为另外 1 组，就和在天平上一样，然后进行 $\frac{1}{3}$ 拿出， $\frac{1}{3}$ 移动， $\frac{1}{3}$ 不动。现在你可以试着用这个方法，重新开始第 3 次测量，你会发现，方案几乎一致。
	  > 思考题：
	  >		1. 如果有 13 个球, 3 次能称量出来吗？如果 14 个了？
		2. 39 个球，最少需要称量几次一定能找出问题球，如果秤？

- ### 最终结论
  
  在前面实际的操作中，我们可以得知，某些步骤或许需要标准球的参与，来让天平两边的球的数目相等，但是第一次操作的时候，并不见得会有标注球提供。由(**公式2**)反推我们得知：  
  
  > 称量 $k$ 次情况下，最多可称量球的个数为 k 的函数: $n(k) = \dfrac{3^k - 1}{2}$ (**公式3**)， 由于 $3^k$ 一定是奇数。  
  
  但是这种情况是默认了总是有标准球提供的情况下，如果没有标准球的时候，那么答案只能从第 $k-1$ 次触发，因为称量一次之后， 总是有标准球出现了。所以修正后答案应该是：  
  
  > $n(k-1) = \dfrac{3^{k-1} -1}2$ , 那么 $n(k) = 3 \times n(k-1) = \dfrac{3^k - 3}2$  
  
  最终我们得出：  
  
  > $$ 
n(k) = \begin{cases}
\dfrac{3^k - 1}2 && \text{有标准球提供} \\
\\
\dfrac{3^k - 3}2 && \text{无标注球提供} \\
\end{cases}
$$

  
  
  如果不考虑一定要称量出轻重，那么小球的数量可以多一个，那时因为有一个小球可以不参与称量，如果最后一次天平平衡，并且还有一个从来没有参与称量的球，那么问题球就是这个球。只是不知偏重还是偏轻而已。  
  
  > 不需要找出问题球轻重的情况下： 
  > $$
n'(k) = n(k) + 1 = \begin{cases}
\dfrac{3^k + 1}2 && 有标准球提供 \\
\\
\dfrac{3^k - 1}2 && 无标准球提供 \\
\end{cases}
$$

  
  有了上面的公式， 根据球的数量 $n$ 来决定衡量需要称量多少次 $k$ ， 可以根据实际情况（有无标准球）和实际需求（是否需要找出轻重）可以反推出来。只是实际操作中，有个小技巧需要掌握，我们知道我们每一次都需要将球分成三等份，拿出其中一份不参与称量，如果球的数量不能整除 $3$ , 那么拿出去的球的数量需要根据实际需求来定，要么向上取整，要么向下取整。以 $13$ 个球为例，其 $13/3 = 4.333...$ 。如果我们必须要找出问题球情况，那么一开始我们就尽量让多的球参与称量，因此向下取整，也就是 $4$ 个球不参与称量; 相应的，如果不必要找出问题球轻重情况，那么就可以 $5$ 个球不参与称量。接下来如何分配天平上的球的数量了，如果参与称量的是偶数，能均分好说，但是如果是奇数了？。第一种情况下，参与称量的球是 $9$ 个，不能均分成两份，因此，如果没有标准球提供，需要再拿出 $1$ 个不参与称量，也就是不参与称量的球也是 $5$ 个；如果有标准球，那么加入 $1$ 个标准球一共 $10$ 个均分即可。实际操作中，总结为：  
  
  > 每一次称量，多少个球不参与称量取决于 $2$ 步:
  >	1. 根据实际需求来拿出 —— 当需要找出轻重情况的时候： $floor(n/3)$ ; 当不需要知道轻重的时候： $ceiling(n/3)$
	2. 此时如果参与称量的球是奇数，根据是否有标准球 —— 当有标准球，加入标准球可以平衡左右两边数目，无需拿出; 当无标注球（只可能发生在第一步），再拿出 $1$ 个即可。

  
  小技巧：  
  > 从第 2 次称量开始以后，可能会出现两组球，一组是重标记，一组是轻标记，两组数量并不一定一样。为了便于跟踪，我们在将 2 组球分成 3 份的时候，尽量只让其中 1 份是混和标记，其中 2 份不是，而且总是可以做到的。分 3 步：
  >	1. 从多的一组拿出总数量为 1/3  的球不参与称量，对于有轻重标记的球来说，向上取整，向下取整无所谓 —— 清一色的标记。
	2. 从多的一堆拿移动总数量为 1/3 的球到另外一边 —— 清一色的标记
	3. 加入一定数量的标准球到少的一侧以平衡天平两边球的数量（经过前面步骤，此时标准球数量一定是够的，有兴趣的可以自行证明）。

  >  
我们举一个极端例子（实际操作不一定会遇到），假设 $11$ 个重标记的球，和 $3$ 个轻标记的球（当然可以是 $14$ 个标记都为重的球，大家可以自行根据上述步骤去实际操作），下面分三步的结果：
  >	1. 标记为重的一组拿出 4 个不参与称量 —— 拿出的标记都为重
	2. 标记重的一组剩下 7 个，仍然数量较多， 那就移动 4 个到轻的那边 —— 移动的都是重标记
	3. 此时一侧 4 个球（原来重标记那侧）， 一侧 7 个球（原来轻标记那侧），只需加入 3 个标准球到其中一侧即可。

### 总结
  1. 三等分样本
  2. 天平平衡的时候，问题很简单，问题小球在没有参与称量的球当中
  3. 天平不平衡的时候，问题小球在天平上面，三等分它们，一份拿出去，一份挪动它们（左边的挪到右边，右边的挪动到左边），一份不动。左右两边数量不等的话用标准球去补充。
    - 天平平衡, 拿出去那份有问题
    - 天平方向改变，挪动的有问题
    - 天平方向保持不变，没动的那份有问题